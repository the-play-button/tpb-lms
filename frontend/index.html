<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LMS - The Play Button</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect fill='%23667eea' width='100' height='100' rx='15'/><polygon fill='white' points='35,25 35,75 75,50'/></svg>">
    <!-- Sentry Error Monitoring -->
    <script src="https://browser.sentry-cdn.com/7.119.0/bundle.min.js" crossorigin="anonymous"></script>
    <script>
      Sentry.init({
        dsn: "https://ad431281807d8cd4ef66862bf77e8a63@o4510471154106368.ingest.us.sentry.io/4510620171829248",
        environment: window.location.hostname.includes('localhost') ? 'development' : 'production',
        tracesSampleRate: 0.1
      });
    </script>
    <link rel="stylesheet" href="styles.css">
    <!-- animations.css now imported via styles.css -->
    <link rel="stylesheet" href="components/toast.css">
    <link rel="stylesheet" href="components/tooltip.css">
    <link rel="stylesheet" href="styles/debug.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=Playfair+Display:wght@600;700&family=JetBrains+Mono&display=swap" rel="stylesheet">
    <script src="https://embed.cloudflarestream.com/embed/sdk.latest.js"></script>
</head>
<body>
    <div class="lms-app">
        <!-- Header with user info -->
        <header class="lms-header">
            <div class="logo">
                <span class="logo-icon">‚ñ∂</span>
                <span class="logo-text">TPB Academy</span>
            </div>
            <div class="user-stats" id="userStats">
                <div class="stat streak">
                    <span class="stat-icon">üî•</span>
                    <span class="stat-value" id="streakDays">0</span>
                    <span class="stat-label">jours</span>
                </div>
                <div class="stat xp">
                    <span class="stat-icon">‚ö°</span>
                    <span class="stat-value" id="totalXP">0</span>
                    <span class="stat-label">XP</span>
                </div>
                <div class="stat level">
                    <span class="stat-icon">üéØ</span>
                    <span class="stat-value">Niveau <span id="userLevel">1</span></span>
                </div>
            </div>
            <!-- User menu with email, role badge, and logout -->
            <div class="user-menu" id="userMenu"></div>
        </header>

        <!-- Main content -->
        <main class="lms-main">
            <!-- Sidebar navigation -->
            <nav class="lms-sidebar">
                <div class="nav-section">
                    <h3>Mon Parcours</h3>
                    <ul class="nav-list" id="somList">
                        <!-- Populated dynamically -->
                    </ul>
                </div>
                <div class="nav-section">
                    <h3>Mes Badges</h3>
                    <div class="badges-grid" id="badgesGrid">
                        <!-- Populated dynamically -->
                    </div>
                </div>
            </nav>

            <!-- Content area -->
            <section class="lms-content">
                <div class="som-viewer" id="somViewer">
                    <!-- SOM content loaded here -->
                    <div class="welcome-screen" id="welcomeScreen">
                        <h1>Bienvenue dans l'Academy TPB</h1>
                        <p>S√©lectionnez un module pour commencer votre apprentissage.</p>
                        <div class="quick-stats">
                            <div class="quick-stat">
                                <span class="quick-stat-value" id="videosWatched">0</span>
                                <span class="quick-stat-label">Vid√©os vues</span>
                            </div>
                            <div class="quick-stat">
                                <span class="quick-stat-value" id="quizzesPassed">0</span>
                                <span class="quick-stat-label">Quiz r√©ussis</span>
                            </div>
                            <div class="quick-stat">
                                <span class="quick-stat-value" id="somsCompleted">0</span>
                                <span class="quick-stat-label">SOMs compl√©t√©s</span>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Leaderboard sidebar -->
            <aside class="lms-leaderboard">
                <h3>üèÜ Classement</h3>
                <div class="leaderboard-tabs">
                    <button class="tab active" data-period="weekly">Semaine</button>
                    <button class="tab" data-period="monthly">Mois</button>
                    <button class="tab" data-period="alltime">Total</button>
                </div>
                <ol class="leaderboard-list" id="leaderboardList">
                    <!-- Populated dynamically -->
                </ol>
            </aside>
        </main>

        <!-- Mobile Parcours View (courses list - hidden on desktop) -->
        <div class="mobile-parcours-view" id="mobileParcoursView">
            <h2>üìö Mon Parcours</h2>
            <div class="course-list" id="mobileCourseList">
                <!-- Populated dynamically -->
            </div>
        </div>

        <!-- Mobile Badges View (badges grid - hidden on desktop) -->
        <div class="mobile-badges-view" id="mobileBadgesView">
            <h2>üèÜ Mes Badges</h2>
            <div class="badges-grid" id="mobileBadgesGrid">
                <!-- Populated dynamically -->
            </div>
        </div>

        <!-- Mobile bottom tab bar (hidden on desktop via CSS) -->
        <nav class="mobile-tabs" id="mobileTabs" aria-label="Navigation mobile">
            <button class="mobile-tab" data-tab="parcours">
                <span class="mobile-tab-icon">üìö</span>
                <span class="mobile-tab-label">Parcours</span>
            </button>
            <button class="mobile-tab active" data-tab="content">
                <span class="mobile-tab-icon">üì∫</span>
                <span class="mobile-tab-label">Cours</span>
            </button>
            <button class="mobile-tab" data-tab="badges">
                <span class="mobile-tab-icon">üèÜ</span>
                <span class="mobile-tab-label">Badges</span>
            </button>
        </nav>
    </div>

    <!-- Notification container -->
    <div class="notifications" id="notifications"></div>

    <!-- Badge detail modal (earned or locked) -->
    <div class="modal" id="badgeModal">
        <div class="modal-content badge-earned">
            <div class="badge-glow"></div>
            <div class="badge-emoji" id="badgeModalEmoji" style="font-size:4rem;margin-bottom:1rem;display:none;"></div>
            <img src="" alt="" class="badge-icon" id="badgeModalIcon">
            <h2 id="badgeModalTitle">Badge D√©bloqu√©!</h2>
            <h3 id="badgeModalName"></h3>
            <p id="badgeModalDescription"></p>
            <span class="badge-xp" id="badgeModalXP">+0 XP</span>
            <button class="modal-close" onclick="closeBadgeModal()">Continuer</button>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="components/toast.js"></script>
    <script type="module" src="app/index.js"></script>
</body>
</html>

